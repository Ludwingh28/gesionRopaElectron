CREATE DATABASE  IF NOT EXISTS `sistema_inventario` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci */ /*!80016 DEFAULT ENCRYPTION='N' */;
USE `sistema_inventario`;
-- MySQL dump 10.13  Distrib 8.0.42, for Win64 (x86_64)
--
-- Host: 127.0.0.1    Database: sistema_inventario
-- ------------------------------------------------------
-- Server version	8.0.42

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `categorias`
--

DROP TABLE IF EXISTS `categorias`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `categorias` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `descripcion` text COLLATE utf8mb4_unicode_ci,
  `activo` tinyint(1) DEFAULT '1',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `nombre` (`nombre`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `categorias`
--

LOCK TABLES `categorias` WRITE;
/*!40000 ALTER TABLE `categorias` DISABLE KEYS */;
INSERT INTO `categorias` VALUES (1,'SHORT','Shorts y bermudas cortas',1,'2025-07-14 05:01:50'),(2,'BERMUDA','Bermudas largas',1,'2025-07-14 05:01:50'),(3,'PANTALON','Pantalones largos',1,'2025-07-14 05:01:50'),(4,'CHAQUETA','Chaquetas y chalecos',1,'2025-07-14 05:01:50'),(5,'CAMISA','Camisas y tops',1,'2025-07-14 05:01:50'),(6,'FALDA','Faldas',1,'2025-07-14 05:01:50'),(7,'CAPRI','Pantalones capri',1,'2025-07-14 05:01:50'),(8,'4XS',NULL,1,'2025-07-14 23:19:11');
/*!40000 ALTER TABLE `categorias` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `colores`
--

DROP TABLE IF EXISTS `colores`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `colores` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `codigo_hex` varchar(7) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `activo` tinyint(1) DEFAULT '1',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `nombre` (`nombre`)
) ENGINE=InnoDB AUTO_INCREMENT=22 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `colores`
--

LOCK TABLES `colores` WRITE;
/*!40000 ALTER TABLE `colores` DISABLE KEYS */;
INSERT INTO `colores` VALUES (1,'BLANCO',NULL,1,'2025-07-14 05:01:50'),(2,'AZUL',NULL,1,'2025-07-14 05:01:50'),(3,'CELESTE',NULL,1,'2025-07-14 05:01:50'),(4,'CAQUI',NULL,1,'2025-07-14 05:01:50'),(5,'NEGRO',NULL,1,'2025-07-14 05:01:50'),(6,'AZUL OSCURO',NULL,1,'2025-07-14 05:01:50'),(7,'AZUL MARINO',NULL,1,'2025-07-14 05:01:50'),(8,'VERDE AGUA',NULL,1,'2025-07-14 05:01:50'),(9,'PLOMO',NULL,1,'2025-07-14 05:01:50'),(10,'CAFÉ',NULL,1,'2025-07-14 05:01:50'),(11,'ANIMAL PRINTS',NULL,1,'2025-07-14 05:01:50'),(12,'CAMEL',NULL,1,'2025-07-14 05:01:50'),(13,'PLOMO JASPEADO',NULL,1,'2025-07-14 05:01:50'),(14,'VERDE MILITAR',NULL,1,'2025-07-14 05:01:50'),(15,'AZUL CLARO',NULL,1,'2025-07-14 05:01:50'),(16,'VERDE OLIVO',NULL,1,'2025-07-14 05:01:50'),(17,'AZUL GRAFITO',NULL,1,'2025-07-14 05:01:50'),(18,'CAQUI OSCURO',NULL,1,'2025-07-14 05:01:50'),(19,'NEGRO GRAFITO',NULL,1,'2025-07-14 05:01:50'),(20,'AZUL BAJO',NULL,1,'2025-07-14 05:01:50'),(21,'CELESTE JASPEADO',NULL,1,'2025-07-14 05:01:50');
/*!40000 ALTER TABLE `colores` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `detalle_ventas`
--

DROP TABLE IF EXISTS `detalle_ventas`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `detalle_ventas` (
  `id` int NOT NULL AUTO_INCREMENT,
  `venta_id` int NOT NULL,
  `inventario_id` int NOT NULL,
  `cantidad` int NOT NULL DEFAULT '1',
  `precio_unitario` decimal(10,2) NOT NULL,
  `subtotal` decimal(12,2) GENERATED ALWAYS AS ((`cantidad` * `precio_unitario`)) STORED,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_venta` (`venta_id`),
  KEY `idx_inventario` (`inventario_id`),
  CONSTRAINT `detalle_ventas_ibfk_1` FOREIGN KEY (`venta_id`) REFERENCES `ventas` (`id`) ON DELETE CASCADE,
  CONSTRAINT `detalle_ventas_ibfk_2` FOREIGN KEY (`inventario_id`) REFERENCES `inventario` (`id`) ON DELETE RESTRICT
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `detalle_ventas`
--

LOCK TABLES `detalle_ventas` WRITE;
/*!40000 ALTER TABLE `detalle_ventas` DISABLE KEYS */;
INSERT INTO `detalle_ventas` (`id`, `venta_id`, `inventario_id`, `cantidad`, `precio_unitario`, `created_at`) VALUES (1,1000,1000,1,220.00,'2025-07-14 05:17:57'),(2,1001,1001,1,780.00,'2025-07-14 05:18:04'),(3,1002,1006,3,264.00,'2025-07-19 18:20:04');
/*!40000 ALTER TABLE `detalle_ventas` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`root`@`localhost`*/ /*!50003 TRIGGER `tr_actualizar_stock_venta` AFTER INSERT ON `detalle_ventas` FOR EACH ROW BEGIN
    -- Actualizar stock
    UPDATE inventario 
    SET stock_actual = stock_actual - NEW.cantidad,
        updated_at = CURRENT_TIMESTAMP
    WHERE id = NEW.inventario_id;
    
    -- Registrar movimiento
    INSERT INTO movimientos_inventario 
    (inventario_id, tipo_movimiento, cantidad, cantidad_anterior, 
     cantidad_nueva, motivo, usuario_id, venta_id)
    SELECT 
        NEW.inventario_id,
        'venta',
        NEW.cantidad,
        stock_actual + NEW.cantidad,
        stock_actual,
        CONCAT('Venta ID: ', NEW.venta_id),
        v.usuario_id,
        NEW.venta_id
    FROM inventario i
    JOIN ventas v ON v.id = NEW.venta_id
    WHERE i.id = NEW.inventario_id;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`root`@`localhost`*/ /*!50003 TRIGGER `tr_calcular_total_venta` AFTER INSERT ON `detalle_ventas` FOR EACH ROW BEGIN
    UPDATE ventas 
    SET subtotal = (
        SELECT COALESCE(SUM(subtotal), 0) 
        FROM detalle_ventas 
        WHERE venta_id = NEW.venta_id
    ),
    total = subtotal - descuento
    WHERE id = NEW.venta_id;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Table structure for table `inventario`
--

DROP TABLE IF EXISTS `inventario`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `inventario` (
  `id` int NOT NULL AUTO_INCREMENT,
  `sku` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `producto_id` int NOT NULL,
  `talla_id` int NOT NULL,
  `color_id` int NOT NULL,
  `stock_actual` int NOT NULL DEFAULT '0',
  `stock_minimo` int DEFAULT '5',
  `ubicacion` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `activo` tinyint(1) DEFAULT '1',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `unique_producto_talla_color` (`producto_id`,`talla_id`,`color_id`),
  UNIQUE KEY `sku` (`sku`),
  KEY `talla_id` (`talla_id`),
  KEY `color_id` (`color_id`),
  KEY `idx_producto` (`producto_id`),
  KEY `idx_stock` (`stock_actual`),
  KEY `idx_sku` (`sku`),
  CONSTRAINT `inventario_ibfk_1` FOREIGN KEY (`producto_id`) REFERENCES `productos` (`id`) ON DELETE RESTRICT,
  CONSTRAINT `inventario_ibfk_2` FOREIGN KEY (`talla_id`) REFERENCES `tallas` (`id`) ON DELETE RESTRICT,
  CONSTRAINT `inventario_ibfk_3` FOREIGN KEY (`color_id`) REFERENCES `colores` (`id`) ON DELETE RESTRICT
) ENGINE=InnoDB AUTO_INCREMENT=1268 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `inventario`
--

LOCK TABLES `inventario` WRITE;
/*!40000 ALTER TABLE `inventario` DISABLE KEYS */;
INSERT INTO `inventario` VALUES (1000,'PROD-001000-3626-BLA',1000,15,1,4,2,NULL,1,'2025-07-14 05:12:34','2025-07-14 05:17:57'),(1001,'PROD-001021-38-AZO',1021,11,6,2,1,NULL,1,'2025-07-14 05:17:36','2025-07-14 05:18:04'),(1002,'PROD-001003-44-AZU',1003,14,2,4,2,NULL,1,'2025-07-14 05:17:40','2025-07-14 05:17:40'),(1003,'PROD-001000-42-AZU',1000,8,2,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1004,'PROD-001000-42-BLA',1000,8,1,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1005,'PROD-001000-40-AZU',1000,7,2,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1006,'PROD-001000-40-BLA',1000,7,1,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 18:20:04'),(1007,'PROD-001000-38-AZU',1000,6,2,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1008,'PROD-001000-38-BLA',1000,6,1,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1009,'PROD-001001-42-AZU',1001,8,2,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1010,'PROD-001001-42-BLA',1001,8,1,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 21:10:04'),(1011,'PROD-001001-40-AZU',1001,7,2,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1012,'PROD-001001-40-BLA',1001,7,1,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1013,'PROD-001001-38-AZU',1001,6,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1014,'PROD-001001-38-BLA',1001,6,1,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1015,'PROD-001002-42-AZU',1002,8,2,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1016,'PROD-001002-42-BLA',1002,8,1,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1017,'PROD-001002-40-AZU',1002,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1018,'PROD-001002-40-BLA',1002,7,1,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1019,'PROD-001002-38-AZU',1002,6,2,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1020,'PROD-001002-38-BLA',1002,6,1,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1021,'PROD-001003-42-AZU',1003,8,2,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1022,'PROD-001003-42-BLA',1003,8,1,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1023,'PROD-001003-40-AZU',1003,7,2,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1024,'PROD-001003-40-BLA',1003,7,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1025,'PROD-001003-38-AZU',1003,6,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1026,'PROD-001003-38-BLA',1003,6,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1027,'PROD-001004-42-AZU',1004,8,2,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1028,'PROD-001004-42-BLA',1004,8,1,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1029,'PROD-001004-40-AZU',1004,7,2,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1030,'PROD-001004-40-BLA',1004,7,1,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1031,'PROD-001004-38-AZU',1004,6,2,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1032,'PROD-001004-38-BLA',1004,6,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1033,'PROD-001005-42-AZU',1005,8,2,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1034,'PROD-001005-42-BLA',1005,8,1,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1035,'PROD-001005-40-AZU',1005,7,2,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1036,'PROD-001005-40-BLA',1005,7,1,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1037,'PROD-001005-38-AZU',1005,6,2,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1038,'PROD-001005-38-BLA',1005,6,1,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1039,'PROD-001006-42-AZU',1006,8,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1040,'PROD-001006-42-BLA',1006,8,1,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1041,'PROD-001006-40-AZU',1006,7,2,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1042,'PROD-001006-40-BLA',1006,7,1,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1043,'PROD-001006-38-AZU',1006,6,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1044,'PROD-001006-38-BLA',1006,6,1,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1045,'PROD-001007-42-AZU',1007,8,2,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1046,'PROD-001007-42-BLA',1007,8,1,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1047,'PROD-001007-40-AZU',1007,7,2,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1048,'PROD-001007-40-BLA',1007,7,1,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1049,'PROD-001007-38-AZU',1007,6,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1050,'PROD-001007-38-BLA',1007,6,1,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1051,'PROD-001008-42-AZU',1008,8,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1052,'PROD-001008-42-BLA',1008,8,1,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1053,'PROD-001008-40-AZU',1008,7,2,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1054,'PROD-001008-40-BLA',1008,7,1,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1055,'PROD-001008-38-AZU',1008,6,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1056,'PROD-001008-38-BLA',1008,6,1,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1057,'PROD-001009-42-AZU',1009,8,2,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1058,'PROD-001009-42-BLA',1009,8,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1059,'PROD-001009-40-AZU',1009,7,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1060,'PROD-001009-40-BLA',1009,7,1,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1061,'PROD-001009-38-AZU',1009,6,2,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1062,'PROD-001009-38-BLA',1009,6,1,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1063,'PROD-001010-42-AZU',1010,8,2,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1064,'PROD-001010-42-BLA',1010,8,1,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1065,'PROD-001010-40-AZU',1010,7,2,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1066,'PROD-001010-40-BLA',1010,7,1,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1067,'PROD-001010-38-AZU',1010,6,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1068,'PROD-001010-38-BLA',1010,6,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1069,'PROD-001011-42-AZU',1011,8,2,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1070,'PROD-001011-42-BLA',1011,8,1,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1071,'PROD-001011-40-AZU',1011,7,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1072,'PROD-001011-40-BLA',1011,7,1,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1073,'PROD-001011-38-AZU',1011,6,2,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1074,'PROD-001011-38-BLA',1011,6,1,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1075,'PROD-001012-42-AZU',1012,8,2,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1076,'PROD-001012-42-BLA',1012,8,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1077,'PROD-001012-40-AZU',1012,7,2,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1078,'PROD-001012-40-BLA',1012,7,1,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1079,'PROD-001012-38-AZU',1012,6,2,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1080,'PROD-001012-38-BLA',1012,6,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1081,'PROD-001013-42-AZU',1013,8,2,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1082,'PROD-001013-42-BLA',1013,8,1,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1083,'PROD-001013-40-AZU',1013,7,2,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1084,'PROD-001013-40-BLA',1013,7,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1085,'PROD-001013-38-AZU',1013,6,2,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1086,'PROD-001013-38-BLA',1013,6,1,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1087,'PROD-001014-42-AZU',1014,8,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1088,'PROD-001014-42-BLA',1014,8,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1089,'PROD-001014-40-AZU',1014,7,2,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1090,'PROD-001014-40-BLA',1014,7,1,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1091,'PROD-001014-38-AZU',1014,6,2,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1092,'PROD-001014-38-BLA',1014,6,1,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1093,'PROD-001015-42-AZU',1015,8,2,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1094,'PROD-001015-42-BLA',1015,8,1,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1095,'PROD-001015-40-AZU',1015,7,2,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1096,'PROD-001015-40-BLA',1015,7,1,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1097,'PROD-001015-38-AZU',1015,6,2,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1098,'PROD-001015-38-BLA',1015,6,1,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1099,'PROD-001016-42-AZU',1016,8,2,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1100,'PROD-001016-42-BLA',1016,8,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1101,'PROD-001016-40-AZU',1016,7,2,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1102,'PROD-001016-40-BLA',1016,7,1,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1103,'PROD-001016-38-AZU',1016,6,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1104,'PROD-001016-38-BLA',1016,6,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1105,'PROD-001017-42-AZU',1017,8,2,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1106,'PROD-001017-42-BLA',1017,8,1,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1107,'PROD-001017-40-AZU',1017,7,2,10,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1108,'PROD-001017-40-BLA',1017,7,1,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1109,'PROD-001017-38-AZU',1017,6,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1110,'PROD-001017-38-BLA',1017,6,1,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1111,'PROD-001018-42-AZU',1018,8,2,8,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1112,'PROD-001018-42-BLA',1018,8,1,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1113,'PROD-001018-40-AZU',1018,7,2,6,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1114,'PROD-001018-40-BLA',1018,7,1,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1115,'PROD-001018-38-AZU',1018,6,2,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1116,'PROD-001018-38-BLA',1018,6,1,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1117,'PROD-001019-42-AZU',1019,8,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1118,'PROD-001019-42-BLA',1019,8,1,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1119,'PROD-001019-40-AZU',1019,7,2,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1120,'PROD-001019-40-BLA',1019,7,1,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1121,'PROD-001019-38-AZU',1019,6,2,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1122,'PROD-001019-38-BLA',1019,6,1,7,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1123,'PROD-001020-42-AZU',1020,8,2,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1124,'PROD-001020-42-BLA',1020,8,1,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1125,'PROD-001020-40-AZU',1020,7,2,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1126,'PROD-001020-40-BLA',1020,7,1,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1127,'PROD-001020-38-AZU',1020,6,2,9,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1128,'PROD-001020-38-BLA',1020,6,1,1,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1130,'PROD-001001-42-NEG',1001,8,5,4,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1131,'PROD-001002-44-AZU',1002,9,2,3,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1132,'PROD-001002-46-AZU',1002,10,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1133,'PROD-001002-M-NEG',1002,2,5,2,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1139,'PROD-001022-40-AZU',1022,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1140,'PROD-001023-40-AZU',1023,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1141,'PROD-001024-40-AZU',1024,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1142,'PROD-001025-40-AZU',1025,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1143,'PROD-001026-40-AZU',1026,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1144,'PROD-001027-40-AZU',1027,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1145,'PROD-001028-40-AZU',1028,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1146,'PROD-001029-40-AZU',1029,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1147,'PROD-001030-40-AZU',1030,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1148,'PROD-001031-40-AZU',1031,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1149,'PROD-001032-40-AZU',1032,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1150,'PROD-001033-40-AZU',1033,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1151,'PROD-001034-40-AZU',1034,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1152,'PROD-001035-40-AZU',1035,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1153,'PROD-001036-40-AZU',1036,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1154,'PROD-001037-40-AZU',1037,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1155,'PROD-001038-40-AZU',1038,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1156,'PROD-001039-40-AZU',1039,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1157,'PROD-001040-40-AZU',1040,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1158,'PROD-001041-40-AZU',1041,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1159,'PROD-001042-40-AZU',1042,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1160,'PROD-001043-40-AZU',1043,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1161,'PROD-001044-40-AZU',1044,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1162,'PROD-001045-40-AZU',1045,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1163,'PROD-001046-40-AZU',1046,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1164,'PROD-001047-40-AZU',1047,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1165,'PROD-001048-40-AZU',1048,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1166,'PROD-001049-40-AZU',1049,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1167,'PROD-001050-40-AZU',1050,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1168,'PROD-001051-40-AZU',1051,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1169,'PROD-001052-40-AZU',1052,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1170,'PROD-001053-40-AZU',1053,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1171,'PROD-001054-40-AZU',1054,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1172,'PROD-001055-40-AZU',1055,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1173,'PROD-001056-40-AZU',1056,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1174,'PROD-001057-40-AZU',1057,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1175,'PROD-001058-40-AZU',1058,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1176,'PROD-001059-40-AZU',1059,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1177,'PROD-001060-40-AZU',1060,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1178,'PROD-001061-40-AZU',1061,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1179,'PROD-001062-40-AZU',1062,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1180,'PROD-001063-40-AZU',1063,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1181,'PROD-001064-40-AZU',1064,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1182,'PROD-001065-40-AZU',1065,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1183,'PROD-001066-40-AZU',1066,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1184,'PROD-001067-40-AZU',1067,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1185,'PROD-001068-40-AZU',1068,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1186,'PROD-001069-40-AZU',1069,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1187,'PROD-001070-40-AZU',1070,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1188,'PROD-001071-40-AZU',1071,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1189,'PROD-001072-40-AZU',1072,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1190,'PROD-001073-40-AZU',1073,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1191,'PROD-001074-40-AZU',1074,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1192,'PROD-001075-40-AZU',1075,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1193,'PROD-001076-40-AZU',1076,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1194,'PROD-001077-40-AZU',1077,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1195,'PROD-001078-40-AZU',1078,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1196,'PROD-001079-40-AZU',1079,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1197,'PROD-001080-40-AZU',1080,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1198,'PROD-001081-40-AZU',1081,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1199,'PROD-001082-40-AZU',1082,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1200,'PROD-001083-40-AZU',1083,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1201,'PROD-001084-40-AZU',1084,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1202,'PROD-001085-40-AZU',1085,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1203,'PROD-001086-40-AZU',1086,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1204,'PROD-001087-40-AZU',1087,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1205,'PROD-001088-40-AZU',1088,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1206,'PROD-001089-40-AZU',1089,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1207,'PROD-001090-40-AZU',1090,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1208,'PROD-001091-40-AZU',1091,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1209,'PROD-001092-40-AZU',1092,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1210,'PROD-001093-40-AZU',1093,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1211,'PROD-001094-40-AZU',1094,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1212,'PROD-001095-40-AZU',1095,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1213,'PROD-001096-40-AZU',1096,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1214,'PROD-001097-40-AZU',1097,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1215,'PROD-001098-40-AZU',1098,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1216,'PROD-001099-40-AZU',1099,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1217,'PROD-001100-40-AZU',1100,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1218,'PROD-001101-40-AZU',1101,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1219,'PROD-001102-40-AZU',1102,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1220,'PROD-001103-40-AZU',1103,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1221,'PROD-001104-40-AZU',1104,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1222,'PROD-001105-40-AZU',1105,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1223,'PROD-001106-40-AZU',1106,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1224,'PROD-001107-40-AZU',1107,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1225,'PROD-001108-40-AZU',1108,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1226,'PROD-001109-40-AZU',1109,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1227,'PROD-001110-40-AZU',1110,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1228,'PROD-001111-40-AZU',1111,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1229,'PROD-001112-40-AZU',1112,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1230,'PROD-001113-40-AZU',1113,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1231,'PROD-001114-40-AZU',1114,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1232,'PROD-001115-40-AZU',1115,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1233,'PROD-001116-40-AZU',1116,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1234,'PROD-001117-40-AZU',1117,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1235,'PROD-001118-40-AZU',1118,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1236,'PROD-001119-40-AZU',1119,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1237,'PROD-001120-40-AZU',1120,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1238,'PROD-001121-40-AZU',1121,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1239,'PROD-001122-40-AZU',1122,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1240,'PROD-001123-40-AZU',1123,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1241,'PROD-001124-40-AZU',1124,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1242,'PROD-001125-40-AZU',1125,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1243,'PROD-001126-40-AZU',1126,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1244,'PROD-001127-40-AZU',1127,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56'),(1245,'PROD-001128-40-AZU',1128,7,2,5,2,NULL,1,'2025-07-19 06:14:56','2025-07-19 06:14:56');
/*!40000 ALTER TABLE `inventario` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`root`@`localhost`*/ /*!50003 TRIGGER `tr_inventario_sku` BEFORE INSERT ON `inventario` FOR EACH ROW BEGIN
    DECLARE producto_codigo VARCHAR(20);
    DECLARE talla_nombre VARCHAR(20);
    DECLARE color_nombre VARCHAR(50);
    DECLARE next_id INT;
    
    -- Obtener el próximo ID que se asignará
    SELECT AUTO_INCREMENT INTO next_id 
    FROM information_schema.TABLES 
    WHERE TABLE_SCHEMA = DATABASE() 
    AND TABLE_NAME = 'inventario';
    
    SELECT COALESCE(codigo_interno, CONCAT('PROD-', LPAD(id, 6, '0'))) INTO producto_codigo 
    FROM productos WHERE id = NEW.producto_id;
    
    SELECT nombre INTO talla_nombre 
    FROM tallas WHERE id = NEW.talla_id;
    
    SELECT nombre INTO color_nombre 
    FROM colores WHERE id = NEW.color_id;
    
    IF NEW.sku IS NULL OR NEW.sku = '' THEN
        SET NEW.sku = CONCAT(
            COALESCE(producto_codigo, 'PROD-000000'), '-', 
            REPLACE(REPLACE(COALESCE(talla_nombre, 'ST'), '/', ''), '.', ''), '-', 
            SUBSTRING(UPPER(COALESCE(color_nombre, 'STD')), 1, 3)
        );
    END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Table structure for table `marcas`
--

DROP TABLE IF EXISTS `marcas`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `marcas` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `descripcion` text COLLATE utf8mb4_unicode_ci,
  `activo` tinyint(1) DEFAULT '1',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `nombre` (`nombre`)
) ENGINE=InnoDB AUTO_INCREMENT=35 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `marcas`
--

LOCK TABLES `marcas` WRITE;
/*!40000 ALTER TABLE `marcas` DISABLE KEYS */;
INSERT INTO `marcas` VALUES (1,'PISOM',NULL,1,'2025-07-14 05:01:50'),(2,'SAMURAI',NULL,1,'2025-07-14 05:01:50'),(3,'EDWIN',NULL,1,'2025-07-14 05:01:50'),(4,'LEVI\'S',NULL,1,'2025-07-14 05:01:50'),(5,'ZAMANY',NULL,1,'2025-07-14 05:01:50'),(6,'VOG',NULL,1,'2025-07-14 05:01:50'),(7,'KALUA',NULL,1,'2025-07-14 05:01:50'),(8,'POPSUGAR',NULL,1,'2025-07-14 05:01:50'),(9,'FUZARKA',NULL,1,'2025-07-14 05:01:50'),(10,'OZZO JEANS',NULL,1,'2025-07-14 05:01:50'),(11,'KANCAN LOS ANGELES',NULL,1,'2025-07-14 05:01:50'),(12,'COZZI',NULL,1,'2025-07-14 05:01:50'),(13,'CAMBRIDGE POLO CLUB',NULL,1,'2025-07-14 05:01:50'),(14,'SHEKINÁ',NULL,1,'2025-07-14 05:01:50'),(15,'VIA ONIX',NULL,1,'2025-07-14 05:01:50'),(16,'MOST WANTED',NULL,1,'2025-07-14 05:01:50'),(17,'BONGO',NULL,1,'2025-07-14 05:01:50'),(18,'REVANCHE',NULL,1,'2025-07-14 05:01:50'),(19,'LOOPPER',NULL,1,'2025-07-14 05:01:50'),(20,'KIDS DENIM BOYS',NULL,1,'2025-07-14 05:01:50'),(21,'AK DENIM',NULL,1,'2025-07-14 05:01:50'),(22,'DENIM LOVERS',NULL,1,'2025-07-14 05:01:50'),(23,'LEGIAO',NULL,1,'2025-07-14 05:01:50'),(24,'DARLOOK',NULL,1,'2025-07-14 05:01:50'),(25,'W.O.B.',NULL,1,'2025-07-14 05:01:50'),(26,'BEM BOLADO',NULL,1,'2025-07-14 05:01:50'),(27,'UNDER GROUND',NULL,1,'2025-07-14 05:01:50'),(28,'LARANJA LIMA',NULL,1,'2025-07-14 05:01:50'),(29,'FERIÑA',NULL,1,'2025-07-14 05:01:50'),(30,'AMORE MIO',NULL,1,'2025-07-14 05:01:50'),(31,'FOR GIRLS',NULL,1,'2025-07-14 05:01:50'),(32,'FOXI JEANS',NULL,1,'2025-07-14 05:01:50'),(33,'DROMEDAR',NULL,1,'2025-07-14 05:01:50'),(34,'LUISBUITON',NULL,1,'2025-07-14 23:19:11');
/*!40000 ALTER TABLE `marcas` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `movimientos_inventario`
--

DROP TABLE IF EXISTS `movimientos_inventario`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `movimientos_inventario` (
  `id` int NOT NULL AUTO_INCREMENT,
  `inventario_id` int NOT NULL,
  `tipo_movimiento` enum('entrada','salida','ajuste','venta','devolucion') COLLATE utf8mb4_unicode_ci NOT NULL,
  `cantidad` int NOT NULL,
  `cantidad_anterior` int NOT NULL,
  `cantidad_nueva` int NOT NULL,
  `motivo` varchar(200) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `usuario_id` int NOT NULL,
  `venta_id` int DEFAULT NULL,
  `fecha_movimiento` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `usuario_id` (`usuario_id`),
  KEY `venta_id` (`venta_id`),
  KEY `idx_inventario` (`inventario_id`),
  KEY `idx_tipo` (`tipo_movimiento`),
  KEY `idx_fecha` (`fecha_movimiento`),
  KEY `idx_movimientos_fecha_tipo` (`fecha_movimiento`,`tipo_movimiento`),
  CONSTRAINT `movimientos_inventario_ibfk_1` FOREIGN KEY (`inventario_id`) REFERENCES `inventario` (`id`) ON DELETE RESTRICT,
  CONSTRAINT `movimientos_inventario_ibfk_2` FOREIGN KEY (`usuario_id`) REFERENCES `usuarios` (`id`) ON DELETE RESTRICT,
  CONSTRAINT `movimientos_inventario_ibfk_3` FOREIGN KEY (`venta_id`) REFERENCES `ventas` (`id`) ON DELETE SET NULL
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `movimientos_inventario`
--

LOCK TABLES `movimientos_inventario` WRITE;
/*!40000 ALTER TABLE `movimientos_inventario` DISABLE KEYS */;
INSERT INTO `movimientos_inventario` VALUES (2,1000,'venta',1,5,4,'Venta ID: 1000',1,1000,'2025-07-14 05:17:57'),(3,1001,'venta',1,3,2,'Venta ID: 1001',2,1001,'2025-07-14 05:18:04'),(4,1006,'venta',3,6,3,'Venta ID: 1002',7,1002,'2025-07-19 18:20:04'),(5,1010,'entrada',4,1,5,'Compra Nueva',7,NULL,'2025-07-19 21:10:04');
/*!40000 ALTER TABLE `movimientos_inventario` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `productos`
--

DROP TABLE IF EXISTS `productos`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `productos` (
  `id` int NOT NULL AUTO_INCREMENT,
  `codigo_interno` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `detalle` text COLLATE utf8mb4_unicode_ci NOT NULL,
  `marca_id` int NOT NULL,
  `categoria_id` int NOT NULL,
  `costo_compra` decimal(10,2) NOT NULL DEFAULT '0.00',
  `precio_venta_base` decimal(10,2) NOT NULL,
  `precio_promotora` decimal(10,2) GENERATED ALWAYS AS ((`precio_venta_base` * 1.20)) STORED,
  `activo` tinyint(1) DEFAULT '1',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `codigo_interno` (`codigo_interno`),
  KEY `idx_marca` (`marca_id`),
  KEY `idx_categoria` (`categoria_id`),
  KEY `idx_codigo` (`codigo_interno`),
  KEY `idx_productos_precio` (`precio_venta_base`),
  CONSTRAINT `productos_ibfk_1` FOREIGN KEY (`marca_id`) REFERENCES `marcas` (`id`) ON DELETE RESTRICT,
  CONSTRAINT `productos_ibfk_2` FOREIGN KEY (`categoria_id`) REFERENCES `categorias` (`id`) ON DELETE RESTRICT
) ENGINE=InnoDB AUTO_INCREMENT=1130 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `productos`
--

LOCK TABLES `productos` WRITE;
/*!40000 ALTER TABLE `productos` DISABLE KEYS */;
INSERT INTO `productos` (`id`, `codigo_interno`, `detalle`, `marca_id`, `categoria_id`, `costo_compra`, `precio_venta_base`, `activo`, `created_at`, `updated_at`) VALUES (1000,'PROD-001000','SHORT JEANS CORTO, BLANCO CASUAL',1,1,140.00,220.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1001,'PROD-001001','SHORT CORTO JEANS ALICRADO- DESGASTE EN PIERNAS',1,1,80.00,130.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1002,'PROD-001002','SHORT JEANS ANCHO ALICRADO, DESFLECADO',1,1,160.00,230.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1003,'PROD-001003','BERMUDA JEANS CORTO- 2 BOTONES EN CINTURA',1,2,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1004,'PROD-001004','BERMUDA JEANS CON ALGUNOS DESGASTES, AZUL',1,2,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1005,'PROD-001005','SHORT JEANS CORTOS DESFLECADOS EN PIERNAS',1,1,140.00,200.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1006,'PROD-001006','BERMUDA MASCULINA JEANS ALICRADO, AZUL',1,2,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1007,'PROD-001007','BERMUDA JEANS MASCULINA ALICRADO- DESGASTE',1,2,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1008,'PROD-001008','BERMUDA JEANS MASCULINA ALICRADO- GASPEADO',1,2,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1009,'PROD-001009','SHORT JEANS CORTO- DOBLES EN PIERNAS, CELESTE',1,1,180.00,265.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1010,'PROD-001010','SHORTO JEANS CORTO- RIGIDO- CAQUI',1,1,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1011,'PROD-001011','SHORT JEANS CORTO- ALICRADO- AZUL OSCURO',1,1,150.00,200.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1012,'PROD-001012','SHORT MEDIA PIERNA- DOBLADILLO EN PIERNA',1,1,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1013,'PROD-001013','SHORT JEANS -NEGRO',1,1,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1014,'PROD-001014','SHORT CON PINZAS ADELANTE Y 5 BOTONES -NEGRO',1,1,180.00,250.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1015,'PROD-001015','CHALECO JEANS CON PIEL DE OSO, AZUL',1,4,210.00,390.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1016,'PROD-001016','BERMUDA CORTA, NEGRA',1,2,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1017,'PROD-001017','PANTALON JEANS, BOTA ANCHA, AZUL',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1018,'PROD-001018','PANTALON JEANS, BOTA RECTA, NEGRO',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1019,'PROD-001019','PANTALON JEANS, BOTA RECTA CON DESGASTE',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1020,'PROD-001020','PANTALON JEANS, BOTA RECTA, C/PINZAS LATERALES',1,3,240.00,450.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1021,'PROD-001021','PANTALON JEANS ALICRADO CHUPIN- 2 BOTONES',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1022,'PROD-001022','PANTALON JEANS, 2 PINZAS ATRÁS Y DET. PINZA',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1023,'PROD-001023','PANTALON JEANS, BOTA RECTA, PLOMO JASPEADO',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1024,'PROD-001024','PANTALON TELA RIGIDA, BOTA ANCHA, ANIMAL',1,3,210.00,440.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1025,'PROD-001025','PANTALON TELA, BOTA ANCHA, CAMEL',1,3,230.00,380.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1026,'PROD-001026','PANTALON JEANS ALICRADO CHUPIN- NEGRO',1,3,170.00,270.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1027,'PROD-001027','PANTALON JEANS ALICRADO -JASPEADO EN PIERNAS',1,3,210.00,380.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1028,'PROD-001028','PANTALON JEANS CHUPIN- DESGASTE BOLSILLO',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1029,'PROD-001029','PANTALON JEANS - JASPEADO EN PIERNAS Y ATRÁS',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1030,'PROD-001030','PANTALON JEANS CHUPIN ALICRADO- DESGASTES',1,3,210.00,370.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1031,'PROD-001031','PANTALON JEANS CHUPIN- DESFLECADO EN TOBILLO',1,3,180.00,290.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1032,'PROD-001032','PANTALON JEANS DE HOMBRE SEMI RIGIDO- JASPEADO',1,3,210.00,350.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1033,'PROD-001033','PANTALON JEANS ALICRADO DE HOMBRE- AZUL',1,3,210.00,350.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1034,'PROD-001034','PANTALON JEANS SEMI ALICRADO DE HOMBRE',1,3,210.00,350.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1035,'PROD-001035','PANTALON LONA SEMI LICRA DE HOMBRE- BOTA',1,3,210.00,350.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1036,'PROD-001036','PANTALON JEANS SEMI ALICRADO DE HOMBRE SAMURAI',2,3,240.00,480.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1037,'PROD-001037','PANTALON JEANS DE HOMBRE -CON ELASTICO SAMURAI',2,3,240.00,480.00,1,'2025-07-14 05:03:26','2025-07-14 05:03:26'),(1038,'PROD-001038','PANTALON DE VESTIR DE HOMBRE -BOTA SEMI SAMURAI',2,3,240.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1039,'PROD-001039','PANTALON JEANS DE HOMBRE SEMI ALICRADO EDWIN',3,3,240.00,480.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1040,'PROD-001040','PANTALON DE VESTIR ALICRADO- BOTA SEMI RECTA EDWIN',3,3,240.00,480.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1041,'PROD-001041','PANTALON LONA ALICRADO- ELASTICO EN CINTURA EDWIN',3,3,240.00,480.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1042,'PROD-001042','PANTALON JEANS DE HOMBRE CLASICO- BOTA LEVI\'S',4,3,150.00,200.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1043,'PROD-001043','PANTALON JEANS ALICRADO DE HOMBRE- BOTA ZAMANY',5,3,240.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1044,'PROD-001044','PANTALON DE HOMBRE CLASICO- BOTA RECTA ZAMANY',5,3,240.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1045,'PROD-001045','PANTALON DE HOMBRE -BOTA SEMI RECTA- CAQUI ZAMANY',5,3,240.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1046,'PROD-001046','BERMUDA JEANS DE HOMBRE SEMI ALICRADO ZAMANY',5,2,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 22:45:18'),(1047,'PROD-001047','BERMUDA ALICRADO DE HOMBRE - VERDE AGUA ZAMANY',5,2,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1048,'PROD-001048','BERMUDA LONA SUAVE DE HOMBRE- CON RELIEVES ZAMANY',5,2,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1049,'PROD-001049','BERMUDA LONA SUAVE DE HOMBRE- NEGRO GRAFITO ZAMANY',5,2,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1050,'PROD-001050','CAMISA JEANS DET.DE A 3 PLIEGUES ADELANTE VOG',6,5,120.00,180.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1051,'PROD-001051','SHORT JEANS ALICRADO, DETALLE CINTURA Y BOLSILLOS VOG',6,1,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1052,'PROD-001052','SHORT JEANS CORTO ALICRADO- DESFLECADO VOG',6,1,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1053,'PROD-001053','CHAQUETA CORTA JEANS, MANGA LARGA, CAFÉ VOG',6,4,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1054,'PROD-001054','PANTALON JEANS- BOTA ANCHA ALICRADO, AZUL VOG',6,3,210.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1055,'PROD-001055','PANTALON JEANS- JASPEADO EN PIERNAS- BOTA VOG',6,3,210.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1056,'PROD-001056','PANTALON JEANS ALICRADO- JASPEADO EN PIERNAS VOG',6,3,210.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1057,'PROD-001057','PANTALON JEANS ALICRADO, BOTA ANCHA, JASPEADO VOG',6,3,210.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1058,'PROD-001058','PANTALON JEANS ALICRADO, BOTA ANCHA, ROTO VOG',6,3,210.00,340.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1059,'PROD-001059','PANTALON JEANS ALICRADO -ROTO EN RODILLAS VOG',6,3,210.00,340.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1060,'PROD-001060','PANTALON JEANS LISO- TALLE ALTO- BOTA ANCHA VOG',6,3,210.00,340.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1061,'PROD-001061','PANTALON JEANS ALICRADO, BOTA RECTA, DESGASTE VOG',6,3,195.00,290.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1062,'PROD-001062','PANTALON JEANS ALICRADO, BOTA ANCHA, PINZA VOG',6,3,195.00,290.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1063,'PROD-001063','PANTALON JEANS ALICRADO, BOTA RECTA, AZUL VOG',6,3,195.00,290.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1064,'PROD-001064','PANTALON BOTA ANCHA ALICRADO, ANIMAL PRINT VOG',6,3,210.00,395.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1065,'PROD-001065','PANTALON JEANS ALICRACO, NEGRO VOG',6,3,210.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1066,'PROD-001066','PANTALON JEANS ALICRADO, CHUPIN- NEGRO VOG',6,3,210.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1067,'PROD-001067','PANTALON JEANS ALICRADO- CHUPIN- BLANCO VOG',6,3,210.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1068,'PROD-001068','PANTALON CHUPIN JEANS ALICRADO- CINTO JEANS VOG',6,3,210.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1069,'PROD-001069','PANTALON JEANS ALICRADO, CHUPIN- CON FAJA VOG',6,3,210.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1070,'PROD-001070','PANTALON JEANS ALICRADO- BOTA CAMPANA- VOG',6,3,210.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1071,'PROD-001071','PANTALON JEANS ALICRADO- PINZA ATRÁS- BOTA VOG',6,3,210.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1072,'PROD-001072','SHORT CORTO JEANS ALICRADO,DETALLE DOBLES KALUA',7,1,180.00,295.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1073,'PROD-001073','PANTALON JEANS ALICRADO CHUPIN- NEGRO KALUA',7,3,195.00,310.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1074,'PROD-001074','PANTALON JEANS CHUPIN- TIRO ALTO- BLANCO KALUA',7,3,180.00,295.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1075,'PROD-001075','PANTALON JEANS CHUPIN- 3 BOTONES EN TOBILLO KALUA',7,3,180.00,295.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1076,'PROD-001076','PANTALON JEANS CHUPIN- TIRO ALTO CON PINZAS KALUA',7,3,180.00,295.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1077,'PROD-001077','PANTALON JEANS CLARO, DESGASTADO EN BOLSILLO KALUA',7,3,210.00,310.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1078,'PROD-001078','PANTALON JEANS JASPEADO, BOTA RECTA, CON KALUA',7,3,210.00,310.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1079,'PROD-001079','PANTALON JEANS, BOTA ANCHA CON BOTONES KALUA',7,3,210.00,310.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1080,'PROD-001080','PANTALON DE LONA ALICRADO LISO, PLOMO HUMO KALUA',7,3,210.00,310.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1081,'PROD-001081','CHAQUETA JEANS, DESFLECADO EN CUELLO, KANCAN LOS ANGELES',11,4,570.00,850.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1082,'PROD-001082','PANTALON JEANS ALICRADO CHUPIN- JASPEADO KANCAN LOS ANGELES',11,3,450.00,650.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1083,'PROD-001083','PANTALON ALICRADO CHUPIN LISO- NEGRO KANCAN LOS ANGELES',11,3,450.00,650.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1084,'PROD-001084','PANTALON JEANS ALICRADO CHUPIN- ROTO DESHILACHADO KANCAN LOS ANGELES',11,3,450.00,650.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1085,'PROD-001085','PANTALON JEANS ALICRADO CHUPIN- TODO JASPEADO KANCAN LOS ANGELES',11,3,450.00,650.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1086,'PROD-001086','PANTALON JEANS ALICRADO CHUPIN- DESGASTE KANCAN LOS ANGELES',11,3,450.00,650.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1087,'PROD-001087','BERMUDA JEANS DESFLECADO DETALLE CORAZONES POPSUGAR',8,2,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1088,'PROD-001088','PANTALON CON BRILLOS HORIZONTALES ADELANTE POPSUGAR',8,3,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1089,'PROD-001089','PANTALON JEANS, BOTA RECTA, CON PINZA ATRÁS POPSUGAR',8,3,180.00,290.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1090,'PROD-001090','BERMUDA JEANS CORTA ALICRADO DE NIÑO, CON FUZARKA',9,2,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1091,'PROD-001091','TOP JEANS, CORDONES LATELARES, AZUL CLARO OZZO JEANS',10,5,200.00,280.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1092,'PROD-001092','CHAQUETA JEANS, DET. DESFLECADO HOMBROS OZZO JEANS',10,4,220.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1093,'PROD-001093','CAMISA JEANS, MANGA LARGA, AZUL COZZI',12,5,150.00,220.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1094,'PROD-001094','PANTALON JEANS ELASTISADA CHUPIN, AZUL COZZI',12,3,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1095,'PROD-001095','CAMISA DE VARON, MANGA LARGA, AZUL CAMBRIDGE POLO CLUB',13,5,200.00,300.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1096,'PROD-001096','FALDA LARGA CON BOTONES EN FRENTE, DET. SHEKINÁ',14,6,250.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1097,'PROD-001097','PANTALON JEANS, CINTURA ALTA C/2 BOTONES VIA ONIX',15,3,100.00,150.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1098,'PROD-001098','PANTALON JEANS RIGIDO- 4 BOTONES DE COLORES VIA ONIX',15,3,110.00,160.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1099,'PROD-001099','PANTALON JEANS LICRA, DET. CINTO CON BRILLOS MOST WANTED',16,3,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1100,'PROD-001100','PANTALON CHUPIN JEANS ALICRADO, CAQUI MOST WANTED',16,3,220.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1101,'PROD-001101','PANTALON CHUPIN JEANS ALICRADO- DESILACHADO MOST WANTED',16,3,180.00,250.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1102,'PROD-001102','PANTALON JEANS ALICRADO- ELASTIZADO EN TOBILLO MST WANTED',16,3,150.00,210.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1103,'PROD-001103','PANTALON JEANS ALICRADO, ROTO UN COSTADO BONGO',17,3,160.00,230.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1104,'PROD-001104','PANTALON JEANS, CLASICO, DET.CINTO DE JEANS REVANCHE',18,3,200.00,280.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1105,'PROD-001105','PANTALON JEANS, BOTA ANGOSTA, AZUL MARINO REVANCHE',18,3,160.00,230.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1106,'PROD-001106','PANTALON JEANS ALICRADO- ELASTICO EN CINTURA LOOPPER',19,3,280.00,390.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1107,'PROD-001107','PANTALON DE LONA ALICRADO LISO- ELASTICO LOOPPER',19,3,280.00,390.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1108,'PROD-001108','PANTALON JEANS ALICRADO CHUPIN- CON ELASTICO LOOPPER',19,3,280.00,390.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1109,'PROD-001109','CAPRI JEANS ALICRADO- ELASTISADO EN CINTURA LOOPPER',19,7,250.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1110,'PROD-001110','PANTALON JEANS CLASICO DE NIÑOS CON ELASTICO KIDS DENIM BOYS',20,3,100.00,140.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1111,'PROD-001111','PANTALON JEANS- BOTA ANCHA CON ABERTURA AK DENIM',21,3,130.00,190.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1112,'PROD-001112','PANTALON JEANS ALICRADO- PIEDRERIA BRILLOSA DENIM LOVERS',22,3,150.00,210.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1113,'PROD-001113','PANTALON JEANS ALICRADO CHUPIN, 2 BOTONES LEGIAO',23,3,200.00,290.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1114,'PROD-001114','PANTALON JEANS ALICRADO- TALLE ALTO- DESGASTE LEGIAO',23,3,250.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1115,'PROD-001115','PANTALON JEANS ALICRADO CHUPIN- PLOMO DARLOOK',24,3,250.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1116,'PROD-001116','PATALON LISO - TACHAS EN BOLSILLOS ATRÁS- W.O.B.',25,3,250.00,350.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1117,'PROD-001117','PANTALONA BOTA ANCHA, 2 BOTONES EN CINTURA BEM BOLADO',26,3,200.00,275.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1118,'PROD-001118','PANTALON JEANS ALICRADO- ELASTIZADO EN CINTURA UNDER GROUND',27,3,230.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1119,'PROD-001119','PANTALON JEANS LISA, BOTA RECTA, NEGRO UNDER GROUND',27,3,230.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1120,'PROD-001120','SHORT JEANS RIGIDO CORTO- CELESTE LARANJA LIMA',28,1,120.00,170.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1121,'PROD-001121','SHORT JEANS RIGIDO CORTO- CON DESGASTE Y LARANJA LIMA',28,1,120.00,170.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1122,'PROD-001122','PANTALON JEANS RIGIDO-BOTA ANCHA -BOLSILLO FERIÑA',29,3,150.00,210.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1123,'PROD-001123','PANTALON JEANS ALICRADO-BOTA RECTA- CAQUI AMORE MIO',30,3,230.00,320.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1124,'PROD-001124','PANTALON JEANS ALICRADO- BICOLOR CELESTE FOR GIRLS',31,3,130.00,190.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1125,'PROD-001125','PANTALON JEANS ALICRADO- TALLE ALTO- BOTA FOXI JEANS',32,3,270.00,380.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1126,'PROD-001126','PANTALON JEANS ALICRADO- JASPEADO EN PIERNAS FOXI JEANS',32,3,270.00,380.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1127,'PROD-001127','PANTALON JEANS ALICRADO- DET. BOTON FORMA FOXI JEANS',32,3,210.00,300.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1128,'PROD-001128','CHAQUETA JEANS ALICRADO- BOLSILLOS DELANTEROS DROMEDAR',33,4,170.00,240.00,1,'2025-07-14 05:03:27','2025-07-14 05:03:27'),(1129,'0P1129','PANTALON DE JEAN',34,8,0.00,100.00,1,'2025-07-14 23:19:11','2025-07-19 21:08:50');
/*!40000 ALTER TABLE `productos` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`root`@`localhost`*/ /*!50003 TRIGGER `tr_producto_codigo_interno` BEFORE INSERT ON `productos` FOR EACH ROW BEGIN
    -- El NEW.id no está disponible en BEFORE INSERT, usamos un método alternativo
    DECLARE next_id INT;
    
    -- Obtener el próximo ID que se asignará
    SELECT AUTO_INCREMENT INTO next_id 
    FROM information_schema.TABLES 
    WHERE TABLE_SCHEMA = DATABASE() 
    AND TABLE_NAME = 'productos';
    
    IF NEW.codigo_interno IS NULL OR NEW.codigo_interno = '' THEN
        SET NEW.codigo_interno = CONCAT('PROD-', LPAD(next_id, 6, '0'));
    END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Table structure for table `roles`
--

DROP TABLE IF EXISTS `roles`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `roles` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `descripcion` text COLLATE utf8mb4_unicode_ci,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `nombre` (`nombre`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `roles`
--

LOCK TABLES `roles` WRITE;
/*!40000 ALTER TABLE `roles` DISABLE KEYS */;
INSERT INTO `roles` VALUES (1,'developer','Desarrollador con acceso completo al sistema','2025-07-14 05:01:50','2025-07-14 05:01:50'),(2,'admin','Administrador con permisos de gestión y ventas','2025-07-14 05:01:50','2025-07-14 05:01:50'),(3,'promotora','Promotora de ventas con precio especial','2025-07-14 05:01:50','2025-07-14 05:01:50');
/*!40000 ALTER TABLE `roles` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `tallas`
--

DROP TABLE IF EXISTS `tallas`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `tallas` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(20) COLLATE utf8mb4_unicode_ci NOT NULL,
  `orden_display` int DEFAULT NULL,
  `activo` tinyint(1) DEFAULT '1',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `nombre` (`nombre`)
) ENGINE=InnoDB AUTO_INCREMENT=40 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `tallas`
--

LOCK TABLES `tallas` WRITE;
/*!40000 ALTER TABLE `tallas` DISABLE KEYS */;
INSERT INTO `tallas` VALUES (1,'S',1,1,'2025-07-14 05:01:50'),(2,'M',2,1,'2025-07-14 05:01:50'),(3,'L',3,1,'2025-07-14 05:01:50'),(4,'XL',4,1,'2025-07-14 05:01:50'),(5,'36',10,1,'2025-07-14 05:01:50'),(6,'38',11,1,'2025-07-14 05:01:50'),(7,'40',12,1,'2025-07-14 05:01:50'),(8,'42',13,1,'2025-07-14 05:01:50'),(9,'44',14,1,'2025-07-14 05:01:50'),(10,'46',15,1,'2025-07-14 05:01:50'),(11,'48',16,1,'2025-07-14 05:01:50'),(12,'50',17,1,'2025-07-14 05:01:50'),(13,'52',18,1,'2025-07-14 05:01:50'),(14,'54',19,1,'2025-07-14 05:01:50'),(15,'36/26',20,1,'2025-07-14 05:01:50'),(16,'0/23',30,1,'2025-07-14 05:01:50'),(17,'1/24',31,1,'2025-07-14 05:01:50'),(18,'3/25',32,1,'2025-07-14 05:01:50'),(19,'5/26',33,1,'2025-07-14 05:01:50'),(20,'7/27',34,1,'2025-07-14 05:01:50'),(21,'9/28',35,1,'2025-07-14 05:01:50'),(22,'11/29',36,1,'2025-07-14 05:01:50'),(23,'13/30',37,1,'2025-07-14 05:01:50'),(24,'3',40,1,'2025-07-14 05:01:50'),(25,'5',41,1,'2025-07-14 05:01:50'),(26,'7',42,1,'2025-07-14 05:01:50'),(27,'9',43,1,'2025-07-14 05:01:50'),(28,'11',44,1,'2025-07-14 05:01:50'),(29,'13',45,1,'2025-07-14 05:01:50'),(30,'15',46,1,'2025-07-14 05:01:50'),(31,'3./4',50,1,'2025-07-14 05:01:50'),(32,'5./6',51,1,'2025-07-14 05:01:50'),(33,'7./8',52,1,'2025-07-14 05:01:50'),(34,'9./10',53,1,'2025-07-14 05:01:50'),(35,'11./12',54,1,'2025-07-14 05:01:50'),(36,'13./14',55,1,'2025-07-14 05:01:50'),(37,'15./16',56,1,'2025-07-14 05:01:50'),(38,'19./20',57,1,'2025-07-14 05:01:50'),(39,'21./22',58,1,'2025-07-14 05:01:50');
/*!40000 ALTER TABLE `tallas` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `usuarios`
--

DROP TABLE IF EXISTS `usuarios`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `usuarios` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `usuario` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `email` varchar(150) COLLATE utf8mb4_unicode_ci NOT NULL,
  `telefono` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `password_hash` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `rol_id` int NOT NULL,
  `activo` tinyint(1) DEFAULT '1',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `usuario` (`usuario`),
  UNIQUE KEY `email` (`email`),
  KEY `rol_id` (`rol_id`),
  CONSTRAINT `usuarios_ibfk_1` FOREIGN KEY (`rol_id`) REFERENCES `roles` (`id`) ON DELETE RESTRICT
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `usuarios`
--

LOCK TABLES `usuarios` WRITE;
/*!40000 ALTER TABLE `usuarios` DISABLE KEYS */;
INSERT INTO `usuarios` VALUES (1,'Administrador','admin','admin@sistema.com','+1234567890','$2y$10$example_hash',2,1,'2025-07-14 05:01:50','2025-07-14 05:01:50'),(2,'María González','maria.gonzalez','maria.promotora@tienda.com','+1234567891','$2y$10$example_hash_maria',3,1,'2025-07-14 05:12:34','2025-07-14 05:12:34'),(3,'Ana Rodríguez','ana.rodriguez','ana.promotora@tienda.com','+1234567892','$2y$10$example_hash_ana',3,1,'2025-07-14 05:12:34','2025-07-14 05:12:34'),(4,'superadmin','developer','superadmin.dev@sistema.com','+1234567893','0192023a7bbd73250516f069df18b500',1,1,'2025-07-14 05:12:34','2025-07-19 21:06:54'),(5,'Ludwing Herrera','dadmin','ludwing.herrera@example.com','1234567890','0192023a7bbd73250516f069df18b500',1,1,'2025-07-19 08:10:48','2025-07-19 21:06:58'),(6,'Ludwing Herrera','ladmin','ludwing.herrera.justiniano@example.com','0987654321','0192023a7bbd73250516f069df18b500',2,1,'2025-07-19 08:10:48','2025-07-19 21:07:04'),(7,'Ludwing Herrera','padmin','ludwing.julian.herrera.justiniano@example.com',NULL,'0192023a7bbd73250516f069df18b500',3,1,'2025-07-19 08:10:48','2025-07-19 21:07:11');
/*!40000 ALTER TABLE `usuarios` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Temporary view structure for view `v_inventario_completo`
--

DROP TABLE IF EXISTS `v_inventario_completo`;
/*!50001 DROP VIEW IF EXISTS `v_inventario_completo`*/;
SET @saved_cs_client     = @@character_set_client;
/*!50503 SET character_set_client = utf8mb4 */;
/*!50001 CREATE VIEW `v_inventario_completo` AS SELECT 
 1 AS `id`,
 1 AS `sku`,
 1 AS `codigo_interno`,
 1 AS `detalle`,
 1 AS `marca`,
 1 AS `categoria`,
 1 AS `talla`,
 1 AS `color`,
 1 AS `stock_actual`,
 1 AS `stock_minimo`,
 1 AS `costo_compra`,
 1 AS `precio_venta_base`,
 1 AS `precio_promotora`,
 1 AS `estado_stock`,
 1 AS `ubicacion`,
 1 AS `activo`*/;
SET character_set_client = @saved_cs_client;

--
-- Temporary view structure for view `v_ventas_detalle`
--

DROP TABLE IF EXISTS `v_ventas_detalle`;
/*!50001 DROP VIEW IF EXISTS `v_ventas_detalle`*/;
SET @saved_cs_client     = @@character_set_client;
/*!50503 SET character_set_client = utf8mb4 */;
/*!50001 CREATE VIEW `v_ventas_detalle` AS SELECT 
 1 AS `venta_id`,
 1 AS `numero_venta`,
 1 AS `fecha_venta`,
 1 AS `vendedor`,
 1 AS `rol_vendedor`,
 1 AS `cliente_nombre`,
 1 AS `total`,
 1 AS `metodo_pago`,
 1 AS `cantidad`,
 1 AS `precio_unitario`,
 1 AS `subtotal`,
 1 AS `producto`,
 1 AS `marca`,
 1 AS `talla`,
 1 AS `color`*/;
SET character_set_client = @saved_cs_client;

--
-- Table structure for table `ventas`
--

DROP TABLE IF EXISTS `ventas`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `ventas` (
  `id` int NOT NULL AUTO_INCREMENT,
  `numero_venta` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `usuario_id` int NOT NULL,
  `cliente_nombre` varchar(200) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `cliente_documento` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `fecha_venta` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `subtotal` decimal(12,2) NOT NULL DEFAULT '0.00',
  `descuento` decimal(12,2) DEFAULT '0.00',
  `total` decimal(12,2) NOT NULL DEFAULT '0.00',
  `estado` enum('pendiente','completada','cancelada') COLLATE utf8mb4_unicode_ci DEFAULT 'completada',
  `metodo_pago` enum('efectivo','tarjeta','transferencia','mixto') COLLATE utf8mb4_unicode_ci DEFAULT 'efectivo',
  `observaciones` text COLLATE utf8mb4_unicode_ci,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `numero_venta` (`numero_venta`),
  KEY `idx_usuario` (`usuario_id`),
  KEY `idx_fecha` (`fecha_venta`),
  KEY `idx_numero` (`numero_venta`),
  KEY `idx_ventas_fecha_usuario` (`fecha_venta`,`usuario_id`),
  CONSTRAINT `ventas_ibfk_1` FOREIGN KEY (`usuario_id`) REFERENCES `usuarios` (`id`) ON DELETE RESTRICT
) ENGINE=InnoDB AUTO_INCREMENT=1003 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `ventas`
--

LOCK TABLES `ventas` WRITE;
/*!40000 ALTER TABLE `ventas` DISABLE KEYS */;
INSERT INTO `ventas` VALUES (1000,'VTA-20250714-1000',1,'Juan Pérez','12345678','2025-07-14 05:17:47',220.00,0.00,220.00,'completada','efectivo',NULL,'2025-07-14 05:17:47'),(1001,'VTA-20250714-1001',2,'Ana García','87654321','2025-07-14 05:18:01',780.00,0.00,780.00,'completada','tarjeta',NULL,'2025-07-14 05:18:01'),(1002,'VTA-20250719-1001',7,'cristian','Sin documento','2025-07-19 18:20:04',792.00,0.00,792.00,'completada','transferencia','','2025-07-19 18:20:04');
/*!40000 ALTER TABLE `ventas` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`root`@`localhost`*/ /*!50003 TRIGGER `tr_venta_numero` BEFORE INSERT ON `ventas` FOR EACH ROW BEGIN
    DECLARE fecha_str VARCHAR(8);
    DECLARE next_id INT;
    
    -- Obtener el próximo ID que se asignará
    SELECT AUTO_INCREMENT INTO next_id 
    FROM information_schema.TABLES 
    WHERE TABLE_SCHEMA = DATABASE() 
    AND TABLE_NAME = 'ventas';
    
    SET fecha_str = DATE_FORMAT(COALESCE(NEW.fecha_venta, NOW()), '%Y%m%d');
    
    IF NEW.numero_venta IS NULL OR NEW.numero_venta = '' THEN
        SET NEW.numero_venta = CONCAT('VTA-', fecha_str, '-', LPAD(next_id, 4, '0'));
    END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Dumping events for database 'sistema_inventario'
--
/*!50106 SET @save_time_zone= @@TIME_ZONE */ ;
/*!50106 DROP EVENT IF EXISTS `ev_limpieza_logs` */;
DELIMITER ;;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;;
/*!50003 SET character_set_client  = utf8mb4 */ ;;
/*!50003 SET character_set_results = utf8mb4 */ ;;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;;
/*!50003 SET @saved_time_zone      = @@time_zone */ ;;
/*!50003 SET time_zone             = 'SYSTEM' */ ;;
/*!50106 CREATE*/ /*!50117 DEFINER=`root`@`localhost`*/ /*!50106 EVENT `ev_limpieza_logs` ON SCHEDULE EVERY 1 MONTH STARTS '2025-07-14 01:01:50' ON COMPLETION NOT PRESERVE ENABLE DO BEGIN
    -- Eliminar movimientos de inventario mayores a 1 año
    DELETE FROM movimientos_inventario 
    WHERE fecha_movimiento < DATE_SUB(NOW(), INTERVAL 1 YEAR);
    
    -- Log de la limpieza
    INSERT INTO movimientos_inventario 
    (inventario_id, tipo_movimiento, cantidad, cantidad_anterior, 
     cantidad_nueva, motivo, usuario_id)
    VALUES 
    (1000, 'ajuste', 0, 0, 0, 'Limpieza automática de logs', 1);
END */ ;;
/*!50003 SET time_zone             = @saved_time_zone */ ;;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;;
/*!50003 SET character_set_client  = @saved_cs_client */ ;;
/*!50003 SET character_set_results = @saved_cs_results */ ;;
/*!50003 SET collation_connection  = @saved_col_connection */ ;;
DELIMITER ;
/*!50106 SET TIME_ZONE= @save_time_zone */ ;

--
-- Dumping routines for database 'sistema_inventario'
--
/*!50003 DROP FUNCTION IF EXISTS `fn_verificar_stock_negativo` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `fn_verificar_stock_negativo`() RETURNS text CHARSET utf8mb4 COLLATE utf8mb4_unicode_ci
    READS SQL DATA
    DETERMINISTIC
BEGIN
    DECLARE resultado TEXT DEFAULT '';
    DECLARE cuenta INT DEFAULT 0;
    
    SELECT COUNT(*) INTO cuenta 
    FROM inventario 
    WHERE stock_actual < 0;
    
    IF cuenta > 0 THEN
        SET resultado = CONCAT('ALERTA: ', cuenta, ' productos con stock negativo encontrados');
    ELSE
        SET resultado = 'OK: Todos los stocks están en valores positivos';
    END IF;
    
    RETURN resultado;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_agregar_articulo_venta` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_agregar_articulo_venta`(
    IN p_venta_id INT,
    IN p_inventario_id INT,
    IN p_cantidad INT,
    OUT p_mensaje VARCHAR(500)
)
BEGIN
    DECLARE v_stock_actual INT;
    DECLARE v_precio_base DECIMAL(10,2);
    DECLARE v_precio_final DECIMAL(10,2);
    DECLARE v_es_promotora BOOLEAN DEFAULT FALSE;
    
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
    BEGIN
        ROLLBACK;
        SET p_mensaje = 'Error al agregar artículo a la venta';
    END;
    
    START TRANSACTION;
    
    -- Verificar stock disponible
    SELECT stock_actual INTO v_stock_actual
    FROM inventario WHERE id = p_inventario_id;
    
    IF v_stock_actual IS NULL THEN
        SET p_mensaje = 'Producto no encontrado';
        ROLLBACK;
    ELSEIF v_stock_actual < p_cantidad THEN
        SET p_mensaje = 'Stock insuficiente';
        ROLLBACK;
    ELSE
        -- Obtener precio base
        SELECT p.precio_venta_base INTO v_precio_base
        FROM inventario i
        JOIN productos p ON i.producto_id = p.id
        WHERE i.id = p_inventario_id;
        
        -- Verificar si el usuario es promotora
        SELECT COUNT(*) > 0 INTO v_es_promotora
        FROM ventas v 
        JOIN usuarios u ON v.usuario_id = u.id
        JOIN roles r ON u.rol_id = r.id
        WHERE v.id = p_venta_id AND r.nombre = 'promotora';
        
        -- Calcular precio final
        IF v_es_promotora THEN
            SET v_precio_final = v_precio_base * 1.20;
        ELSE
            SET v_precio_final = v_precio_base;
        END IF;
        
        -- Agregar el artículo
        INSERT INTO detalle_ventas (venta_id, inventario_id, cantidad, precio_unitario)
        VALUES (p_venta_id, p_inventario_id, p_cantidad, v_precio_final);
        
        SET p_mensaje = 'Artículo agregado exitosamente';
        
        COMMIT;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_productos_stock_bajo` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_productos_stock_bajo`()
BEGIN
    SELECT 
        i.sku,
        p.codigo_interno,
        p.detalle,
        m.nombre AS marca,
        t.nombre AS talla,
        col.nombre AS color,
        i.stock_actual,
        i.stock_minimo,
        (i.stock_minimo - i.stock_actual) AS deficit
    FROM inventario i
    JOIN productos p ON i.producto_id = p.id
    JOIN marcas m ON p.marca_id = m.id
    JOIN tallas t ON i.talla_id = t.id
    JOIN colores col ON i.color_id = col.id
    WHERE i.stock_actual <= i.stock_minimo
    AND i.activo = TRUE
    ORDER BY deficit DESC, i.stock_actual ASC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_realizar_venta` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_realizar_venta`(
    IN p_usuario_id INT,
    IN p_cliente_nombre VARCHAR(200),
    IN p_cliente_documento VARCHAR(50),
    IN p_metodo_pago VARCHAR(20),
    IN p_observaciones TEXT,
    OUT p_venta_id INT,
    OUT p_mensaje VARCHAR(500)
)
BEGIN
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
    BEGIN
        ROLLBACK;
        SET p_mensaje = 'Error al procesar la venta';
        SET p_venta_id = 0;
    END;
    
    START TRANSACTION;
    
    -- Verificar que el usuario existe y puede vender
    IF NOT EXISTS (
        SELECT 1 FROM usuarios u 
        JOIN roles r ON u.rol_id = r.id 
        WHERE u.id = p_usuario_id 
        AND r.nombre IN ('admin', 'promotora')
        AND u.activo = TRUE
    ) THEN
        SET p_mensaje = 'Usuario no autorizado para realizar ventas';
        SET p_venta_id = 0;
        ROLLBACK;
    ELSE
        -- Crear la venta
        INSERT INTO ventas (usuario_id, cliente_nombre, cliente_documento, 
                           metodo_pago, observaciones)
        VALUES (p_usuario_id, p_cliente_nombre, p_cliente_documento, 
                p_metodo_pago, p_observaciones);
        
        SET p_venta_id = LAST_INSERT_ID();
        SET p_mensaje = 'Venta creada exitosamente';
        
        COMMIT;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_reporte_productos_mas_vendidos` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_reporte_productos_mas_vendidos`(
    IN p_fecha_inicio DATE,
    IN p_fecha_fin DATE,
    IN p_limite INT
)
BEGIN
    -- Establecer valor por defecto si es NULL
    IF p_limite IS NULL OR p_limite <= 0 THEN
        SET p_limite = 20;
    END IF;
    
    SET @sql = CONCAT(
        'SELECT 
            p.codigo_interno,
            p.detalle,
            m.nombre AS marca,
            c.nombre AS categoria,
            SUM(dv.cantidad) AS total_vendido,
            SUM(dv.subtotal) AS total_facturado,
            AVG(dv.precio_unitario) AS precio_promedio
        FROM productos p
        JOIN marcas m ON p.marca_id = m.id
        JOIN categorias c ON p.categoria_id = c.id
        JOIN inventario i ON p.id = i.producto_id
        JOIN detalle_ventas dv ON i.id = dv.inventario_id
        JOIN ventas v ON dv.venta_id = v.id
        WHERE DATE(v.fecha_venta) BETWEEN "', p_fecha_inicio, '" AND "', p_fecha_fin, '"
        AND v.estado = "completada"
        GROUP BY p.id, p.codigo_interno, p.detalle, m.nombre, c.nombre
        ORDER BY total_vendido DESC
        LIMIT ', p_limite
    );
    
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_reporte_ventas_promotora` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_reporte_ventas_promotora`(
    IN p_fecha_inicio DATE,
    IN p_fecha_fin DATE
)
BEGIN
    SELECT 
        u.nombre AS promotora,
        COUNT(v.id) AS total_ventas,
        SUM(v.total) AS total_facturado,
        AVG(v.total) AS promedio_venta,
        SUM(dv.cantidad) AS articulos_vendidos
    FROM usuarios u
    JOIN roles r ON u.rol_id = r.id
    JOIN ventas v ON u.id = v.usuario_id
    JOIN detalle_ventas dv ON v.id = dv.venta_id
    WHERE r.nombre = 'promotora'
    AND DATE(v.fecha_venta) BETWEEN p_fecha_inicio AND p_fecha_fin
    AND v.estado = 'completada'
    GROUP BY u.id, u.nombre
    ORDER BY total_facturado DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Final view structure for view `v_inventario_completo`
--

/*!50001 DROP VIEW IF EXISTS `v_inventario_completo`*/;
/*!50001 SET @saved_cs_client          = @@character_set_client */;
/*!50001 SET @saved_cs_results         = @@character_set_results */;
/*!50001 SET @saved_col_connection     = @@collation_connection */;
/*!50001 SET character_set_client      = utf8mb4 */;
/*!50001 SET character_set_results     = utf8mb4 */;
/*!50001 SET collation_connection      = utf8mb4_0900_ai_ci */;
/*!50001 CREATE ALGORITHM=UNDEFINED */
/*!50013 DEFINER=`root`@`localhost` SQL SECURITY DEFINER */
/*!50001 VIEW `v_inventario_completo` AS select `i`.`id` AS `id`,`i`.`sku` AS `sku`,`p`.`codigo_interno` AS `codigo_interno`,`p`.`detalle` AS `detalle`,`m`.`nombre` AS `marca`,`c`.`nombre` AS `categoria`,`t`.`nombre` AS `talla`,`col`.`nombre` AS `color`,`i`.`stock_actual` AS `stock_actual`,`i`.`stock_minimo` AS `stock_minimo`,`p`.`costo_compra` AS `costo_compra`,`p`.`precio_venta_base` AS `precio_venta_base`,`p`.`precio_promotora` AS `precio_promotora`,(case when (`i`.`stock_actual` <= 0) then 'SIN STOCK' when (`i`.`stock_actual` <= `i`.`stock_minimo`) then 'STOCK BAJO' else 'STOCK OK' end) AS `estado_stock`,`i`.`ubicacion` AS `ubicacion`,`i`.`activo` AS `activo` from (((((`inventario` `i` join `productos` `p` on((`i`.`producto_id` = `p`.`id`))) join `marcas` `m` on((`p`.`marca_id` = `m`.`id`))) join `categorias` `c` on((`p`.`categoria_id` = `c`.`id`))) join `tallas` `t` on((`i`.`talla_id` = `t`.`id`))) join `colores` `col` on((`i`.`color_id` = `col`.`id`))) */;
/*!50001 SET character_set_client      = @saved_cs_client */;
/*!50001 SET character_set_results     = @saved_cs_results */;
/*!50001 SET collation_connection      = @saved_col_connection */;

--
-- Final view structure for view `v_ventas_detalle`
--

/*!50001 DROP VIEW IF EXISTS `v_ventas_detalle`*/;
/*!50001 SET @saved_cs_client          = @@character_set_client */;
/*!50001 SET @saved_cs_results         = @@character_set_results */;
/*!50001 SET @saved_col_connection     = @@collation_connection */;
/*!50001 SET character_set_client      = utf8mb4 */;
/*!50001 SET character_set_results     = utf8mb4 */;
/*!50001 SET collation_connection      = utf8mb4_0900_ai_ci */;
/*!50001 CREATE ALGORITHM=UNDEFINED */
/*!50013 DEFINER=`root`@`localhost` SQL SECURITY DEFINER */
/*!50001 VIEW `v_ventas_detalle` AS select `v`.`id` AS `venta_id`,`v`.`numero_venta` AS `numero_venta`,`v`.`fecha_venta` AS `fecha_venta`,`u`.`nombre` AS `vendedor`,`r`.`nombre` AS `rol_vendedor`,`v`.`cliente_nombre` AS `cliente_nombre`,`v`.`total` AS `total`,`v`.`metodo_pago` AS `metodo_pago`,`dv`.`cantidad` AS `cantidad`,`dv`.`precio_unitario` AS `precio_unitario`,`dv`.`subtotal` AS `subtotal`,`p`.`detalle` AS `producto`,`m`.`nombre` AS `marca`,`t`.`nombre` AS `talla`,`col`.`nombre` AS `color` from ((((((((`ventas` `v` join `usuarios` `u` on((`v`.`usuario_id` = `u`.`id`))) join `roles` `r` on((`u`.`rol_id` = `r`.`id`))) join `detalle_ventas` `dv` on((`v`.`id` = `dv`.`venta_id`))) join `inventario` `i` on((`dv`.`inventario_id` = `i`.`id`))) join `productos` `p` on((`i`.`producto_id` = `p`.`id`))) join `marcas` `m` on((`p`.`marca_id` = `m`.`id`))) join `tallas` `t` on((`i`.`talla_id` = `t`.`id`))) join `colores` `col` on((`i`.`color_id` = `col`.`id`))) */;
/*!50001 SET character_set_client      = @saved_cs_client */;
/*!50001 SET character_set_results     = @saved_cs_results */;
/*!50001 SET collation_connection      = @saved_col_connection */;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2025-07-19 18:36:17
